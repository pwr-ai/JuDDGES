schema: '2.0'
stages:
  build_fine_tuning_dataset:
    cmd: PYTHONPATH=. python scripts/sft/build_fine_tuning_dataset.py --dataset-dir
      data/datasets/pl/raw --repo-id JuDDGES/pl-court-instruct
    deps:
    - path: data/datasets/pl/raw
      hash: md5
      md5: 5dd44be2eea852bcce3d0918ff8b97da.dir
      size: 10234880729
      nfiles: 17
    - path: scripts/sft/build_fine_tuning_dataset.py
      hash: md5
      md5: f07a9d106853e74be4d0e4807b33ff3d
      size: 5393
  evaluate_zero_shot:
    cmd: PYTHONPATH=. python scripts/sft/evaluate_zero_shot.py --output-file data/results/pl/zero_shot/results_llama_3_8B.json
      --metrics-file data/results/pl/zero_shot/metrics_llama_3_8B.json
    deps:
    - path: scripts/sft/evaluate_zero_shot.py
      hash: md5
      md5: 1b5fd40e348f17bd2fe78e98244c4d6c
      size: 3826
    outs:
    - path: data/results/pl/zero_shot/metrics_llama_3_8B.json
      hash: md5
      md5: 95ac287e74bc109f224b95b12e5b17f4
      size: 170
    - path: data/results/pl/zero_shot/results_llama_3_8B.json
      hash: md5
      md5: 93f78708a597fad33b3da43e505b9707
      size: 957343
  evaluate_zero_shot@config0:
    cmd: PYTHONPATH=. python scripts/sft/evaluate_zero_shot.py --llm meta-llama/Meta-Llama-3-8B-Instruct
      --output-file data/results/pl_court_instruct/zero_shot/results_meta_llama_3_8B_instruct.json
      --metrics-file data/results/pl_court_instruct/zero_shot/metrics_meta_llama_3_8B_instruct.json
    deps:
    - path: scripts/sft/evaluate_zero_shot.py
      hash: md5
      md5: 26555545a062ce43602a8ac11280bbde
      size: 2714
    outs:
    - path: data/results/pl_court_instruct/zero_shot/metrics_meta_llama_3_8B_instruct.json
      hash: md5
      md5: fb665645d904d37e14a931e38fef9915
      size: 188
    - path: data/results/pl_court_instruct/zero_shot/results_meta_llama_3_8B_instruct.json
      hash: md5
      md5: 93f78708a597fad33b3da43e505b9707
      size: 957343
  fine_tune_sft@Mistral-7B-Instruct-v0.2:
    cmd: PYTHONPATH=. python scripts/sft/fine_tune_llm.py model=Mistral-7B-Instruct-v0.2
    deps:
    - path: configs/fine_tuning.yaml
      hash: md5
      md5: 9cd6fd320530e1c8ded7d9c369b8a082
      size: 440
    - path: configs/model/Mistral-7B-Instruct-v0.2.yaml
      hash: md5
      md5: 68461d0ab4970d1083a2d8fe191f5cd1
      size: 141
    - path: scripts/sft/fine_tune_llm.py
      hash: md5
      md5: d0c843f9066296b6654bbb0b81652da2
      size: 7012
    outs:
    - path: data/experiments/fine-tune/Mistral-7B-Instruct-v0.2/pl-court-instruct
      hash: md5
      md5: 4962aefc4af2bf7f96c4ba1cdb2a9918.dir
      size: 387238698
      nfiles: 44
  predict@Mistral-7B-Instruct-v0.2:
    cmd: PYTHONPATH=. python scripts/sft/predict.py model=Mistral-7B-Instruct-v0.2
    deps:
    - path: configs/model/Mistral-7B-Instruct-v0.2.yaml
      hash: md5
      md5: 68461d0ab4970d1083a2d8fe191f5cd1
      size: 141
    - path: configs/predict.yaml
      hash: md5
      md5: e6b047cf62e612a32381d6221eb99b4e
      size: 416
    - path: scripts/sft/predict.py
      hash: md5
      md5: d0d05a225ca7d9bbf1d9ad60a4fb4663
      size: 3090
    outs:
    - path: data/experiments/predict/pl-court-instruct/outputs_Mistral-7B-Instruct-v0.2.json
      hash: md5
      md5: 3d27738cbbc4c7bde92584d2d44a329d
      size: 2209577
  predict@Meta-Llama-3-8B-Instruct:
    cmd: PYTHONPATH=. python scripts/sft/predict.py model=Meta-Llama-3-8B-Instruct
    deps:
    - path: configs/model/Meta-Llama-3-8B-Instruct.yaml
      hash: md5
      md5: eb67ce09d1c076f42ac161c36501a73e
      size: 141
    - path: configs/predict.yaml
      hash: md5
      md5: e6b047cf62e612a32381d6221eb99b4e
      size: 416
    - path: scripts/sft/predict.py
      hash: md5
      md5: d0d05a225ca7d9bbf1d9ad60a4fb4663
      size: 3090
    outs:
    - path: data/experiments/predict/pl-court-instruct/outputs_Meta-Llama-3-8B-Instruct.json
      hash: md5
      md5: f9a13687ad85b6c4538cd13cb6c60724
      size: 20963
  predict@Mistral-7B-Instruct-v0.2-fine-tuned:
    cmd: PYTHONPATH=. python scripts/sft/predict.py model=Mistral-7B-Instruct-v0.2-fine-tuned
    deps:
    - path: configs/model/Mistral-7B-Instruct-v0.2-fine-tuned.yaml
      hash: md5
      md5: e9cdbe31c62745a86d3a0d1262bd95f6
      size: 222
    - path: configs/predict.yaml
      hash: md5
      md5: e6b047cf62e612a32381d6221eb99b4e
      size: 416
    - path: scripts/sft/predict.py
      hash: md5
      md5: d0d05a225ca7d9bbf1d9ad60a4fb4663
      size: 3090
    outs:
    - path: 
        data/experiments/predict/pl-court-instruct/outputs_Mistral-7B-Instruct-v0.2-fine-tuned.json
      hash: md5
      md5: adf03a2b51a7a9cd4431c884a89f6497
      size: 1843278
  evaluate@Mistral-7B-Instruct-v0.2:
    cmd: PYTHONPATH=. python scripts/sft/evaluate.py  --output-file data/experiments/predict/pl-court-instruct/outputs_Mistral-7B-Instruct-v0.2.json
    deps:
    - path: data/experiments/predict/pl-court-instruct/outputs_Mistral-7B-Instruct-v0.2.json
      hash: md5
      md5: 3d27738cbbc4c7bde92584d2d44a329d
      size: 2209577
    - path: scripts/sft/evaluate.py
      hash: md5
      md5: 5ee442a9a3525af7596bf24c3d724a1d
      size: 570
    outs:
    - path: data/experiments/predict/pl-court-instruct/metrics_Mistral-7B-Instruct-v0.2.json
      hash: md5
      md5: a3116f4a1f47ca64b4926d35d69855bb
      size: 308
  evaluate@Mistral-7B-Instruct-v0.2-fine-tuned:
    cmd: PYTHONPATH=. python scripts/sft/evaluate.py  --output-file 
      data/experiments/predict/pl-court-instruct/outputs_Mistral-7B-Instruct-v0.2-fine-tuned.json
    deps:
    - path: 
        data/experiments/predict/pl-court-instruct/outputs_Mistral-7B-Instruct-v0.2-fine-tuned.json
      hash: md5
      md5: adf03a2b51a7a9cd4431c884a89f6497
      size: 1843278
    - path: scripts/sft/evaluate.py
      hash: md5
      md5: 5ee442a9a3525af7596bf24c3d724a1d
      size: 570
    outs:
    - path: 
        data/experiments/predict/pl-court-instruct/metrics_Mistral-7B-Instruct-v0.2-fine-tuned.json
      hash: md5
      md5: 32c8a6e388f68e1c10e7b8fd5852e6d6
      size: 306
  evaluate@Meta-Llama-3-8B-Instruct:
    cmd: PYTHONPATH=. python scripts/sft/evaluate.py  --output-file data/experiments/predict/pl-court-instruct/outputs_Meta-Llama-3-8B-Instruct.json
    deps:
    - path: data/experiments/predict/pl-court-instruct/outputs_Meta-Llama-3-8B-Instruct.json
      hash: md5
      md5: f9a13687ad85b6c4538cd13cb6c60724
      size: 20963
    - path: scripts/sft/evaluate.py
      hash: md5
      md5: 5ee442a9a3525af7596bf24c3d724a1d
      size: 570
    outs:
    - path: data/experiments/predict/pl-court-instruct/metrics_Meta-Llama-3-8B-Instruct.json
      hash: md5
      md5: 051ccb01be98f323a11ec29d5a6be31b
      size: 293
  sft@Mistral-7B-Instruct-v0.2:
    cmd: PYTHONPATH=. python scripts/sft/fine_tune_llm.py model=Mistral-7B-Instruct-v0.2
    deps:
    - path: configs/fine_tuning.yaml
      hash: md5
      md5: 9cd6fd320530e1c8ded7d9c369b8a082
      size: 440
    - path: configs/model/Mistral-7B-Instruct-v0.2.yaml
      hash: md5
      md5: 68461d0ab4970d1083a2d8fe191f5cd1
      size: 141
    - path: scripts/sft/fine_tune_llm.py
      hash: md5
      md5: d0c843f9066296b6654bbb0b81652da2
      size: 7012
    outs:
    - path: data/experiments/fine-tune/Mistral-7B-Instruct-v0.2/pl-court-instruct
      hash: md5
      md5: 4962aefc4af2bf7f96c4ba1cdb2a9918.dir
      size: 387238698
      nfiles: 44
  embed@mmlw-roberta-large:
    cmd: PYTHONPATH=. python scripts/embed_text.py embedding_model=mmlw-roberta-large
    deps:
    - path: configs/embedding.yaml
      hash: md5
      md5: e7515e27e3bb7ddb3a2062a46efaa773
      size: 408
    - path: configs/embedding_model/mmlw-roberta-large.yaml
      hash: md5
      md5: 22f36cfd196c0fdc3cfd8a036d52b606
      size: 52
    - path: data/datasets/pl/raw
      hash: md5
      md5: 5dd44be2eea852bcce3d0918ff8b97da.dir
      size: 10234880729
      nfiles: 17
    - path: scripts/embed_text.py
      hash: md5
      md5: 5813b589760b00ce693365a36c519ef0
      size: 3384
    outs:
    - path: data/embeddings/pl-court-raw/mmlw-roberta-large
      hash: md5
      md5: b8ab133416880430c1f2d3d8357ffd7f.dir
      size: 24368123117
      nfiles: 53
  predict@Unsloth-Llama-3-8B-Instruct-fine-tuned:
    cmd: PYTHONPATH=. python scripts/sft/predict.py model=Unsloth-Llama-3-8B-Instruct-fine-tuned
    deps:
    - path: configs/model/Unsloth-Llama-3-8B-Instruct-fine-tuned.yaml
      hash: md5
      md5: c9fab7cd7a4b0159d13ba61e3c516c0a
      size: 244
    - path: configs/predict.yaml
      hash: md5
      md5: e6b047cf62e612a32381d6221eb99b4e
      size: 416
    - path: scripts/sft/predict.py
      hash: md5
      md5: 69e4844a715c9c5c75e1127a06472ad4
      size: 3148
    outs:
    - path: 
        data/experiments/predict/pl-court-instruct/outputs_Unsloth-Llama-3-8B-Instruct-fine-tuned.json
      hash: md5
      md5: 9199da7e04fb35cc1ce2bbe9dd5cd274
      size: 1891254
