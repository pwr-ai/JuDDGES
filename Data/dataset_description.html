<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Raw &amp; Instruct Datasets Analyses – juddges</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ebc57992554dae5230fa85c1bd5a55fa.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Raw &amp; Instruct Datasets Analyses – juddges">
<meta property="og:description" content="">
<meta property="og:image" content="https://laugustyniak.github.io/juddges/Data/01_Dataset_Description_files/figure-html/cell-4-output-1.png">
<meta property="og:site_name" content="juddges">
<meta property="og:image:height" content="467">
<meta property="og:image:width" content="572">
<meta name="twitter:title" content="Raw &amp; Instruct Datasets Analyses – juddges">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://laugustyniak.github.io/juddges/Data/01_Dataset_Description_files/figure-html/cell-4-output-1.png">
<meta name="twitter:image-height" content="467">
<meta name="twitter:image-width" content="572">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">juddges</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Data/prepare_instruction_dataset_for_ir.html">Data</a></li><li class="breadcrumb-item"><a href="../Data/dataset_description.html">Raw &amp; Instruct Datasets Analyses</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JuDDGES</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/prepare_instruction_dataset_for_ir.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schema-based information retrieval from judgements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/dataset_description.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Raw &amp; Instruct Datasets Analyses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/analyse_sft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SFT results inspection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/graph_dataset_description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph dataset analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/graph_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Local subgraphs analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/analyze_en_judgements_texts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyze Text of England and Wales Judgements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/analyse_en_dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyse England and Wales Dataset</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Data/hybrid_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example of hybrid search for our indexed data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Dataset Cards</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dataset Cards/dataset_description_raw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataset Card for <a href="https://huggingface.co/datasets/JuDDGES/pl-court-raw">JuDDGES/pl-court-raw</a></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Dataset Cards/dataset_description_instruct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataset Card for <a href="https://huggingface.co/datasets/JuDDGES/pl-court-instruct">JuDDGES/pl-court-instruct</a></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Presentations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Presentations/workshop_demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop Demo</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataset-description" id="toc-dataset-description" class="nav-link active" data-scroll-target="#dataset-description">Dataset description</a>
  <ul class="collapse">
  <li><a href="#data-acquisition" id="toc-data-acquisition" class="nav-link" data-scroll-target="#data-acquisition">1. Data acquisition</a></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing">Data preprocessing</a></li>
  <li><a href="#instruction-dataset-creation" id="toc-instruction-dataset-creation" class="nav-link" data-scroll-target="#instruction-dataset-creation">Instruction dataset creation</a></li>
  </ul></li>
  <li><a href="#instruction-dataset" id="toc-instruction-dataset" class="nav-link" data-scroll-target="#instruction-dataset">Instruction dataset</a>
  <ul class="collapse">
  <li><a href="#split-sizes" id="toc-split-sizes" class="nav-link" data-scroll-target="#split-sizes">Split sizes</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/laugustyniak/juddges/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Data/prepare_instruction_dataset_for_ir.html">Data</a></li><li class="breadcrumb-item"><a href="../Data/dataset_description.html">Raw &amp; Instruct Datasets Analyses</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Raw &amp; Instruct Datasets Analyses</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div id="initial_id" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datasets <span class="im">import</span> load_dataset</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.ticker <span class="im">as</span> ticker</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> AutoTokenizer</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>sns.set_theme(<span class="st">"notebook"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3105d222" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>raw_ds <span class="op">=</span> pl.scan_parquet(source<span class="op">=</span><span class="st">"../../data/datasets/pl/raw/*"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>raw_ds.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['_id',
 'signature',
 'date',
 'publicationDate',
 'lastUpdate',
 'courtId',
 'departmentId',
 'type',
 'excerpt',
 'content',
 'chairman',
 'decision',
 'judges',
 'legalBases',
 'publisher',
 'recorder',
 'references',
 'reviser',
 'themePhrases',
 'num_pages',
 'text',
 'vol_number',
 'vol_type',
 'court_name',
 'department_name',
 'text_legal_bases',
 'thesis']</code></pre>
</div>
</div>
<section id="dataset-description" class="level2">
<h2 class="anchored" data-anchor-id="dataset-description">Dataset description</h2>
<p>The dataset consists of Polish Court judgements available at https://orzeczenia.ms.gov.pl/, containing full content of the judgements along with metadata sourced from official API and extracted from the judgement contents. Dataset was build in 3 stages, namely: 1. Data acquisition 2. Data preprocessing and extraction 3. Instruction dataset generation Following, we provide detailed description of each stage.</p>
<section id="data-acquisition" class="level3">
<h3 class="anchored" data-anchor-id="data-acquisition">1. Data acquisition</h3>
<p>First, we leveraged the official API to download all available judgements along with their metadata. The download procedure resulted in <strong>414 148</strong> documents, containing documents published no later than <code>2024-03-06</code>. Among all documents, <strong>408 423</strong> (98.62%) contain content of the judgement, hence are usable for the further processing and final dataset.</p>
<p>Acquired data consists of the following features:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 60%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Feature name</th>
<th>Feature description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>_id</td>
<td>unique identifier of the judgement</td>
<td><code>string</code></td>
</tr>
<tr class="even">
<td>signature</td>
<td>signature of judgement (unique within court)</td>
<td><code>string</code></td>
</tr>
<tr class="odd">
<td>date</td>
<td>date of judgement</td>
<td><code>datetime</code> (ISO format with timezone)</td>
</tr>
<tr class="even">
<td>publicationDate</td>
<td>date of judgement publication</td>
<td><code>datetime</code> (ISO format with timezone)</td>
</tr>
<tr class="odd">
<td>lastUpdate</td>
<td>date of last update of judgement</td>
<td><code>datetime</code> (ISO format with timezone)</td>
</tr>
<tr class="even">
<td>courtId</td>
<td>system unique identifier of the court</td>
<td><code>int</code></td>
</tr>
<tr class="odd">
<td>departmentId</td>
<td>system unique identifier of the court’s department</td>
<td><code>int</code></td>
</tr>
<tr class="even">
<td>type</td>
<td>type of the judgement (one of )</td>
<td><code>string</code></td>
</tr>
<tr class="odd">
<td>excerpt</td>
<td>First 500 characters of the judgement</td>
<td><code>string</code> or <code>None</code></td>
</tr>
<tr class="even">
<td>content</td>
<td>Full content of judgement as XML file</td>
<td><code>string</code> or <code>None</code></td>
</tr>
<tr class="odd">
<td>chairman</td>
<td>chairman judge name</td>
<td><code>string</code></td>
</tr>
<tr class="even">
<td>decision</td>
<td>decision</td>
<td><code>string</code> or <code>None</code></td>
</tr>
<tr class="odd">
<td>judges</td>
<td>list of judge names participating in the judgement</td>
<td><code>list[string]</code></td>
</tr>
<tr class="even">
<td>legalBases</td>
<td>legal acts which are bases for the judgement (with references to online repository</td>
<td><code>list[dict[str, str]]</code></td>
</tr>
</tbody>
</table>
</section>
<section id="data-preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="data-preprocessing">Data preprocessing</h3>
<p>For further processing, we used only documents containing judgement content. During preprocessing, we extracted additional metadata from the content XML, and then converted XML to plain text. XML files contain tagged metadata which could be readily extracted with arbitrary XML parser. In particular, we were able to extend metadata fields described above by extracting following ones from XML:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 49%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>Feature name</th>
<th>Feature description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>text_legal_bases</td>
<td>legal bases names found in text</td>
<td><code>list[dict[str, str]]</code></td>
</tr>
<tr class="even">
<td>num_pages</td>
<td>numer of pages of the original document</td>
<td><code>int</code></td>
</tr>
<tr class="odd">
<td>vol_number</td>
<td>volume number</td>
<td><code>int</code></td>
</tr>
<tr class="even">
<td>vol_type</td>
<td>volume type</td>
<td><code>string</code></td>
</tr>
<tr class="odd">
<td>text</td>
<td>plain text extracted from content XML</td>
<td><code>string</code></td>
</tr>
</tbody>
</table>
<p>In addition we mapped <code>courtId</code> and <code>departmentId</code> fields according to mapping acquired from https://orzeczenia.wroclaw.sa.gov.pl/indices. During this procedure we identified that some judgements have incorrect court or department identifiers, and decided to leave their names as empty values. In the aftermath, mapping resulted in the additional two columns: | Feature name | Feature description | Type | |—————–|—————————–|———-| | court_name | full name of the court | <code>string</code> | | department_name | full name of the court’s department | <code>string</code> |</p>
<p>All acquired and preprocessed data is stored in <code>MongoDB</code> dataset, and for further processing we performed dataset dump. The dumped dataset was used to create intruction dataset for information extraction. Also, we publish raw dataset dump called <code>pl-court-judgments-raw</code>.</p>
<div id="5c2f63ac" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>court_distribution <span class="op">=</span> raw_ds.drop_nulls(subset<span class="op">=</span><span class="st">"court_name"</span>).select(<span class="st">"court_name"</span>).group_by(<span class="st">"court_name"</span>).<span class="bu">len</span>().sort(<span class="st">"len"</span>, descending<span class="op">=</span><span class="va">True</span>).collect().to_pandas()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.histplot(data<span class="op">=</span>court_distribution, x<span class="op">=</span><span class="st">"len"</span>, log_scale<span class="op">=</span><span class="va">True</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(title<span class="op">=</span><span class="st">"Distribution of judgments per court"</span>, xlabel<span class="op">=</span><span class="st">"#Judgements in single court"</span>, ylabel<span class="op">=</span><span class="st">"Count"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="12acf455" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>judgements_per_year <span class="op">=</span> raw_ds.select(<span class="st">"date"</span>).collect()[<span class="st">"date"</span>].<span class="bu">str</span>.split(<span class="st">" "</span>).<span class="bu">list</span>.get(<span class="dv">0</span>).<span class="bu">str</span>.to_date().dt.year().value_counts().sort(<span class="st">"date"</span>).to_pandas()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>judgements_per_year <span class="op">=</span> judgements_per_year[judgements_per_year[<span class="st">"date"</span>] <span class="op">&lt;</span> <span class="dv">2024</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.pointplot(data<span class="op">=</span>judgements_per_year, x<span class="op">=</span><span class="st">"date"</span>, y<span class="op">=</span><span class="st">"count"</span>, linestyles<span class="op">=</span><span class="st">"--"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Year"</span>, ylabel<span class="op">=</span><span class="st">"Number of Judgements"</span>, title<span class="op">=</span><span class="st">"Yearly Number of Judgements"</span>, yscale<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3df2d2fa" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>types <span class="op">=</span> raw_ds.fill_null(value<span class="op">=</span><span class="st">"&lt;null&gt;"</span>).select(<span class="st">"type"</span>).group_by(<span class="st">"type"</span>).<span class="bu">len</span>().sort(<span class="st">"len"</span>, descending<span class="op">=</span><span class="va">True</span>).collect().to_pandas()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(data<span class="op">=</span>types, x<span class="op">=</span><span class="st">"len"</span>, y<span class="op">=</span><span class="st">"type"</span>, errorbar<span class="op">=</span><span class="va">None</span>, ax<span class="op">=</span>ax)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Count"</span>, ylabel<span class="op">=</span><span class="st">"Type"</span>, title<span class="op">=</span><span class="st">"Judgement types cardinality"</span>, xscale<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="e0801346" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>num_judges <span class="op">=</span> raw_ds.with_columns([pl.col(<span class="st">"judges"</span>).<span class="bu">list</span>.<span class="bu">len</span>().alias(<span class="st">"num_judges"</span>)]).select(<span class="st">"num_judges"</span>).sort(<span class="st">"num_judges"</span>).collect().to_pandas()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.histplot(data<span class="op">=</span>num_judges, x<span class="op">=</span><span class="st">"num_judges"</span>, bins<span class="op">=</span>num_judges[<span class="st">"num_judges"</span>].nunique())</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"#Judges per judgement"</span>, ylabel<span class="op">=</span><span class="st">"Count"</span>, yscale<span class="op">=</span><span class="st">"log"</span>, title<span class="op">=</span><span class="st">"#Judges per single judgement"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="758f41b7" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>num_lb <span class="op">=</span> raw_ds.with_columns([pl.col(<span class="st">"legalBases"</span>).<span class="bu">list</span>.<span class="bu">len</span>().alias(<span class="st">"num_lb"</span>)]).select(<span class="st">"num_lb"</span>).sort(<span class="st">"num_lb"</span>).collect().to_pandas()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.histplot(data<span class="op">=</span>num_lb, x<span class="op">=</span><span class="st">"num_lb"</span>, bins<span class="op">=</span>num_lb[<span class="st">"num_lb"</span>].nunique())</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"#Legal bases"</span>, ylabel<span class="op">=</span><span class="st">"Count"</span>, yscale<span class="op">=</span><span class="st">"log"</span>, title<span class="op">=</span><span class="st">"#Legal bases per judgement"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b1f2f3de" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>raw_text_ds <span class="op">=</span> load_dataset(<span class="st">"parquet"</span>, data_dir<span class="op">=</span><span class="st">"../../data/datasets/pl/raw/"</span>, columns<span class="op">=</span>[<span class="st">"_id"</span>, <span class="st">"text"</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>raw_text_ds <span class="op">=</span> raw_text_ds.<span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="st">"text"</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7ed8f55b2b2048339371aff7955eb6a1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div id="030652c5" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> AutoTokenizer.from_pretrained(<span class="st">"meta-llama/Meta-Llama-3-8B"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenize(batch: <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">list</span>]) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">int</span>]: </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    tokenized <span class="op">=</span> tokenizer(batch[<span class="st">"text"</span>], add_special_tokens<span class="op">=</span><span class="va">False</span>, return_attention_mask<span class="op">=</span><span class="va">False</span>, return_token_type_ids<span class="op">=</span><span class="va">False</span>, return_length<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"length"</span>: tokenized[<span class="st">"length"</span>]}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>raw_text_ds <span class="op">=</span> raw_text_ds.<span class="bu">map</span>(tokenize, batched<span class="op">=</span><span class="va">True</span>, batch_size<span class="op">=</span><span class="dv">16</span>, remove_columns<span class="op">=</span>[<span class="st">"text"</span>], num_proc<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>raw_text_ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>DatasetDict({
    train: Dataset({
        features: ['_id', 'length'],
        num_rows: 408423
    })
})</code></pre>
</div>
</div>
<div id="b8f46bd1" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>judgement_len <span class="op">=</span> raw_text_ds[<span class="st">"train"</span>].to_pandas()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.histplot(data<span class="op">=</span>judgement_len, x<span class="op">=</span><span class="st">"length"</span>, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"#Tokens"</span>, ylabel<span class="op">=</span><span class="st">"Count"</span>, title<span class="op">=</span><span class="st">"#Tokens distribution in judgements (llama-3 tokenizer)"</span>, yscale<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(ticker.FuncFormatter(<span class="kw">lambda</span> x, pos: <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(x<span class="op">/</span><span class="dv">1_000</span>)<span class="sc">}</span><span class="ss">k'</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4b180955" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>per_type_tokens <span class="op">=</span> raw_ds.fill_null(value<span class="op">=</span><span class="st">"&lt;null&gt;"</span>).select([<span class="st">"_id"</span>, <span class="st">"type"</span>]).collect().to_pandas().set_index(<span class="st">"_id"</span>).join(judgement_len.set_index(<span class="st">"_id"</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.boxenplot(data<span class="op">=</span>per_type_tokens, y<span class="op">=</span><span class="st">"type"</span>, x<span class="op">=</span><span class="st">"length"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xscale<span class="op">=</span><span class="st">"log"</span>, title<span class="op">=</span><span class="st">"Judgement token count per type"</span>, xlabel<span class="op">=</span><span class="st">"#Tokens"</span>, ylabel<span class="op">=</span><span class="st">"Type"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="instruction-dataset-creation" class="level3">
<h3 class="anchored" data-anchor-id="instruction-dataset-creation">Instruction dataset creation</h3>
<p>In order to verify and fine-tune Large Language Models in task of automated information extraction from judgements, we built instruction dataset as follows. First, we identified information from metadata which is contained in text of the judgement. Therefore, the following fields were selected for extraction as targets: * <code>date</code> * <code>judges</code> * <code>recorder</code> * <code>signature</code> * <code>court_name</code> * <code>department_name</code> * <code>legal_bases</code></p>
<p>In order to ensure high quality of the dataset, we performed filtering procedure, as described below.</p>
<section id="data-filtering" class="level4">
<h4 class="anchored" data-anchor-id="data-filtering">Data filtering</h4>
<ol type="1">
<li>Removal of judgements with missing values in targets - if any of the target field has missing value, entire judgement is discarded (information might still be contained in judgement text, and in such case the targets would be incorrect)</li>
<li>Cleaning <code>judges</code> field - in some examples, names of judges were concatenated into single name instead of being list of names, so we split them based on conjunction</li>
<li>Removing examples wherein targets are not in text - due to inherent errors in acquired data, some targets might be mistyped, hence we filter them out</li>
</ol>
<p>Data cleaning removes 173297 examples, and dataset consists of 240851.</p>
</section>
<section id="generating-instructions" class="level4">
<h4 class="anchored" data-anchor-id="generating-instructions">Generating instructions</h4>
<p>After cleaning we generate instructions for information extraction. Specifically, we define same prompt for each document, as follows:</p>
<pre class="text"><code>You are extracting information from the Polish court judgments.
Extract specified values strictly from the provided judgement. If information is not provided in the judgement, leave the field with null value.
Please return the response in the identical YAML format:
'''yaml
court_name: "&lt;nazwa sądu, string containing the full name of the court&gt;"
date: &lt;data, date in format YYYY-MM-DD&gt;
department_name: "&lt;nazwa wydziału, string containing the full name of the court's department&gt;"
judges: "&lt;sędziowie, list of judge full names&gt;"
legal_bases: &lt;podstawy prawne, list of strings containing legal bases (legal regulations)&gt;
recorder: &lt;protokolant, string containing the name of the recorder&gt;
signature: &lt;sygnatura, string contraining the signature of the judgment&gt;
'''
=====
{context}
======</code></pre>
<p>where <code>{context}</code> is replaced by text of each judgement. We highlight that judements are in Polish, hence to foster model responding in Polish, we provide name Polish names of the field in the prompt.</p>
</section>
</section>
</section>
<section id="instruction-dataset" class="level1">
<h1>Instruction dataset</h1>
<p>The dataset consists of 4 fields:</p>
<ul>
<li><code>_id</code> - unique identifier of the judgement</li>
<li><code>prompt</code> - prompt containing instruction with <code>{context}</code> variable which should be substituted with <code>context</code></li>
<li><code>context</code> - judgement content (plain text)</li>
<li><code>output</code> - label, expected output of the model</li>
</ul>
<p>We divided dataset into <code>train</code> and <code>test</code> split with the following sizes: | Split | size | fraction | |——-|——–|———-| | train | 238851 | 99.17 | | test | 2000 | 0.83 |</p>
<div id="b0a9fadbe55113ae" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>instruct_ds <span class="op">=</span> load_dataset(<span class="st">"JuDDGES/pl-court-instruct"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>instruct_ds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>DatasetDict({
    train: Dataset({
        features: ['_id', 'prompt', 'context', 'output'],
        num_rows: 238851
    })
    test: Dataset({
        features: ['_id', 'prompt', 'context', 'output'],
        num_rows: 2000
    })
})</code></pre>
</div>
</div>
<section id="split-sizes" class="level3">
<h3 class="anchored" data-anchor-id="split-sizes">Split sizes</h3>
<div id="46fe9b52a576f403" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame([{<span class="st">"Split"</span>:k, <span class="st">"#"</span>: <span class="bu">len</span>(v)} <span class="cf">for</span> k, v <span class="kw">in</span> instruct_ds.items()])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"%"</span>] <span class="op">=</span> df[<span class="st">"#"</span>] <span class="op">/</span> df[<span class="st">"#"</span>].<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Split</th>
<th data-quarto-table-cell-role="th">#</th>
<th data-quarto-table-cell-role="th">%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>train</td>
<td>238851</td>
<td>99.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>test</td>
<td>2000</td>
<td>0.83</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<div id="b97f8f04a9da405a" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch <span class="im">import</span> le</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenize_and_comp_length_instruct_ds(batch: <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">list</span>]) <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">list</span>]:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    tokenized_ctx <span class="op">=</span> tokenizer(batch[<span class="st">"context"</span>], add_special_tokens<span class="op">=</span><span class="va">False</span>, return_attention_mask<span class="op">=</span><span class="va">False</span>, return_token_type_ids<span class="op">=</span><span class="va">False</span>, return_length<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    tokenized_out <span class="op">=</span> tokenizer(batch[<span class="st">"output"</span>], add_special_tokens<span class="op">=</span><span class="va">False</span>, return_attention_mask<span class="op">=</span><span class="va">False</span>, return_token_type_ids<span class="op">=</span><span class="va">False</span>, return_length<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"context_num_tokens"</span>: tokenized_ctx[<span class="st">"length"</span>], <span class="st">"output_num_tokens"</span>: tokenized_out[<span class="st">"length"</span>]}</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>instruct_ds_tok <span class="op">=</span> instruct_ds.<span class="bu">map</span>(tokenize_and_comp_length_instruct_ds, batched<span class="op">=</span><span class="va">True</span>, batch_size<span class="op">=</span><span class="dv">32</span>, remove_columns<span class="op">=</span>[<span class="st">"prompt"</span>, <span class="st">"context"</span>, <span class="st">"output"</span>], num_proc<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>instruct_ds_tok <span class="op">=</span> pd.concat([instruct_ds_tok[<span class="st">"train"</span>].to_pandas(), instruct_ds_tok[<span class="st">"test"</span>].to_pandas()], axis<span class="op">=</span><span class="dv">0</span>, keys<span class="op">=</span>[<span class="st">"train"</span>, <span class="st">"test"</span>]).reset_index(level<span class="op">=</span><span class="dv">0</span>).rename(columns<span class="op">=</span>{<span class="st">"level_0"</span>: <span class="st">"split"</span>})</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>instruct_ds_tok.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">split</th>
<th data-quarto-table-cell-role="th">_id</th>
<th data-quarto-table-cell-role="th">context_num_tokens</th>
<th data-quarto-table-cell-role="th">output_num_tokens</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>train</td>
<td>150515100001006_II_K_000220_2017_Uz_2017-10-03...</td>
<td>2371</td>
<td>134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>train</td>
<td>152500000001521_III_AUa_000581_2013_Uz_2014-02...</td>
<td>5984</td>
<td>233</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>train</td>
<td>155500000000503_I_ACa_000098_2016_Uz_2016-06-1...</td>
<td>21328</td>
<td>128</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>train</td>
<td>150510000000503_I_Ca_000018_2016_Uz_2016-01-28...</td>
<td>369</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>train</td>
<td>150515300001006_II_K_000438_2018_Uz_2018-11-14...</td>
<td>6918</td>
<td>143</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2fb9dbed" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"0.95 quantile of maximum output: </span><span class="sc">{</span>instruct_ds_tok[<span class="st">'output_num_tokens'</span>]<span class="sc">.</span>quantile(<span class="fl">0.95</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.95 quantile of maximum output: 295.0</code></pre>
</div>
</div>
<div id="f2d697bc0f215db" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tok_melt <span class="op">=</span> instruct_ds_tok.melt(id_vars<span class="op">=</span>[<span class="st">"split"</span>], value_vars<span class="op">=</span>[<span class="st">"context_num_tokens"</span>, <span class="st">"output_num_tokens"</span>], var_name<span class="op">=</span><span class="st">"Text"</span>, value_name<span class="op">=</span><span class="st">"#Tokens"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tok_melt[<span class="st">"Text"</span>] <span class="op">=</span> tok_melt[<span class="st">"Text"</span>].<span class="bu">map</span>({<span class="st">"context_num_tokens"</span>: <span class="st">"Context"</span>, <span class="st">"output_num_tokens"</span>: <span class="st">"Output"</span>})</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>tok_melt, x<span class="op">=</span><span class="st">"#Tokens"</span>, col<span class="op">=</span><span class="st">"Text"</span>, hue<span class="op">=</span><span class="st">"split"</span>, kind<span class="op">=</span><span class="st">"kde"</span>, fill<span class="op">=</span><span class="va">True</span>, log_scale<span class="op">=</span><span class="va">True</span>, common_norm<span class="op">=</span><span class="va">False</span>, facet_kws<span class="op">=</span><span class="bu">dict</span>(sharex<span class="op">=</span><span class="va">False</span>, sharey<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>g.figure.suptitle(<span class="st">"Distribution of #Tokens (llama-3 tokenizer) in Context and Output in instruct dataset"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>g.figure.tight_layout()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a89289b2" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(data<span class="op">=</span>per_type_tokens.join(instruct_ds_tok.set_index(<span class="st">"_id"</span>), how<span class="op">=</span><span class="st">"right"</span>), y<span class="op">=</span><span class="st">"type"</span>, hue<span class="op">=</span><span class="st">"split"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xscale<span class="op">=</span><span class="st">"log"</span>, title<span class="op">=</span><span class="st">"Distribution of types in dataset splits"</span>, xlabel<span class="op">=</span><span class="st">"Count"</span>, ylabel<span class="op">=</span><span class="st">"Type"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="01_Dataset_Description_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/laugustyniak\.github\.io\/juddges");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/laugustyniak/juddges/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>